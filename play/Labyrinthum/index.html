

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BPGAMES - IsoTower Multiplayer</title>
<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<!-- Theme fonts -->
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Orbitron:wght@700&family=Roboto+Mono&display=swap" rel="stylesheet">
<!-- Local CSS -->
<link rel="stylesheet" href="index.css">
<!-- 
  FIX: Embedded all game-specific CSS directly into the HTML.
  This completely eliminates any potential issues with the browser failing to find 
  or load the external 'game.css' file, guaranteeing that the pause menu,
  admin console, and other DOM elements are always styled correctly.
-->
<style>
/* 
  This stylesheet contains all CSS rules specifically for the Phaser game's
  DOM elements, such as the game container, menus, popups, and the admin console.
  It is kept separate from the main website's styling (index.css).
*/

/* --- PHASER GAME SPECIFIC STYLES --- */
#root {
    position: relative; /* CRITICAL: This establishes a positioning context for the absolute-positioned UI children. */
    /* Define the ideal size of the game container */
    width: 1280px;
    height: 720px;
    
    /* Ensure it doesn't overflow its parent on smaller viewports */
    max-width: 100%;
    
    /* Let height adjust automatically based on the aspect ratio as width shrinks */
    height: auto;
    aspect-ratio: 1280 / 720;

    /* Center the container within the hero section */
    margin: auto;
    
    overflow: hidden; 
    border-radius: 5px;
    box-shadow: 0 0 0 3px #f97316, 0 0 20px rgba(249, 115, 22, 0.5);
}

#root:fullscreen,
#root:-webkit-full-screen,
#root:-moz-full-screen,
#root:-ms-fullscreen {
    width: 100% !important;
    height: 100% !important;
    background-color: #000;
    display: flex !important; /* Use flex to easily center the canvas */
    align-items: center !important;
    justify-content: center !important;
    aspect-ratio: unset;
    max-width: none !important;
    max-height: none !important;
}

#root canvas {
    display: block;
    margin: auto;
    width: 100% !important;
    height: 100% !important;
}

/* --- PAUSE MENU & UI OVERLAYS (NEW DECOUPLED STRUCTURE) --- */
/* 
  These containers are now direct children of #root. Using absolute positioning
  and z-index ensures they overlay the Phaser canvas correctly.
*/
#pause-menu-container,
#admin-console-container,
#invite-popup-container {
    position: absolute;
    z-index: 100;
    pointer-events: auto; /* Allow interaction */
    font-family: 'Roboto Mono', monospace;
    color: #e0e0e0;
}

/* Default state for all UI overlays is hidden */
#pause-menu-container,
#admin-console-container,
#invite-popup-container {
    display: none;
}
#pause-menu-container.visible,
#admin-console-container.visible,
#invite-popup-container.visible {
    display: flex; /* Use flex for easy centering/layout */
}


/* --- PAUSE MENU STYLING --- */
#pause-menu-container {
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(18, 18, 18, 0.85);
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    align-items: center;
    justify-content: center;
    gap: 2rem;
}

.pause-menu-panel, .player-list-panel {
    background-color: #1f1f1f;
    padding: 2rem;
    border-radius: 8px;
    border: 1px solid #444;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
}

.pause-menu-panel {
    min-width: 280px;
    gap: 1rem;
}

.panel-title {
    font-family: 'Bebas Neue', cursive;
    font-size: 2.5rem;
    color: #f97316;
    text-align: center;
    margin: 0 0 1rem 0;
    letter-spacing: 1px;
}

.menu-btn {
    width: 100%;
    background-color: #333;
    color: #eee;
    border: 1px solid #555;
    padding: 0.75rem;
    border-radius: 5px;
    font-family: 'Roboto Mono', monospace;
    font-size: 1.1rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
}

.menu-btn:hover {
    background-color: #444;
    border-color: #f97316;
    color: #f97316;
}

.menu-btn--danger {
    border-color: #dc2626;
    color: #f87171;
}

.menu-btn--danger:hover {
    background-color: #dc2626;
    border-color: #ef4444;
    color: #fff;
}

.player-list-panel {
    width: 300px;
    height: 407px; /* Match height of pause menu panel */
    padding: 1.5rem;
    gap: 1rem;
}

.player-list-panel .panel-title {
    font-size: 2rem;
    margin-bottom: 0;
}

.player-list-body {
    flex-grow: 1;
    overflow-y: auto;
    background-color: #1a1a1a;
    padding: 10px;
    border-radius: 3px;
}

.player-entry {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px;
    border-bottom: 1px solid #333;
}
.player-entry:last-child { border-bottom: none; }
.player-name { color: #ddd; }
.player-invite-btn {
    padding: 5px 10px;
    background-color: #f97316;
    color: #121212;
    border: none;
    border-radius: 3px;
    cursor: pointer;
    font-family: 'Roboto Mono', monospace;
    transition: background-color 0.2s;
}
.player-invite-btn:hover { background-color: #fb923c; }
.player-invite-btn:disabled {
    background-color: #555;
    color: #999;
    cursor: not-allowed;
}
.player-status { font-style: italic; color: #888; }
.player-status--tower { color: #a29bfe; }


/* --- INVITE POPUP STYLING --- */
#invite-popup-container {
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); /* Center the popup */
    background-color: #222;
    padding: 2rem;
    border-radius: 10px;
    border: 2px solid #f97316;
    text-align: center;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
    flex-direction: column;
}

.invite-popup-text {
    font-size: 1.25rem;
    color: white;
    margin: 0 0 1.5rem 0;
}

.invite-popup-actions {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
}

.invite-popup-btn {
    padding: 10px 30px;
    font-size: 1rem;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-family: 'Bebas Neue', cursive;
    letter-spacing: 1px;
    transition: opacity 0.2s;
}
.invite-popup-btn:hover { opacity: 0.9; }
.invite-popup-btn.btn-accept { background-color: #22c55e; }
.invite-popup-btn.btn-decline { background-color: #ef4444; }


/* --- ADMIN CONSOLE STYLING --- */
/*
  FIX: Position is now absolute relative to #root. Top and right properties
  fix it to the top right corner. The drifting bug is impossible with this CSS.
*/
#admin-console-container {
    top: 10px;
    right: 10px;
    width: 450px;
    max-width: 40%;
    height: 60%;
    max-height: 500px;
    background-color: rgba(18, 18, 18, 0.92);
    border: 2px solid #f97316;
    border-radius: 5px;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    flex-direction: column;
    padding: 15px;
}

.console-output {
    flex-grow: 1;
    overflow-y: auto;
    font-size: 1rem;
    color: #e0e0e0;
    margin-bottom: 15px;
    padding-right: 10px;
}
.console-output div { padding: 5px 0; line-height: 1.6; }
.console-output .log-command { color: #f97316; }
.console-output .log-system { color: #60a5fa; font-style: italic; }
.console-output .log-error { color: #ef4444; }

.console-input {
    width: 100%;
    background-color: #1f1f1f;
    border: 1px solid #555;
    color: #e0e0e0;
    padding: 12px;
    border-radius: 3px;
    outline: none;
    font-size: 1rem;
}
.console-input:focus { border-color: #f97316; }

/* --- RESPONSIVE STYLES for DECOUPLED UI --- */
@media (max-width: 767px) {
    #pause-menu-container {
        flex-direction: column;
        gap: 1rem;
    }
    .pause-menu-panel, .player-list-panel {
        width: 90%;
        max-width: 320px;
        padding: 1.5rem;
        height: auto;
    }
    .player-list-panel { max-height: 250px; }
    .panel-title { font-size: 2rem; }
    #invite-popup-container {
        width: 90%;
        max-width: 320px;
        padding: 1.5rem;
    }
    .invite-popup-text { font-size: 1.1rem; }
    
    #admin-console-container {
        width: 90%;
        max-width: 90%;
        height: 50%;
        padding: 10px;
    }
    .console-input { padding: 10px; }
}
</style>
<!-- Phaser.js library -->
<script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>
<!-- Game Logic -->
<script type="module" src="index.js"></script>
<link rel="stylesheet" href="/index.css">
</head>
<body>

<div class="main-content">
    <header class="header">
        <div class="container">
            <div class="navbar">
                <a href="/" class="logo">
                    <span class="logo-accent">BP</span>GAMES
                </a>
                <nav class="desktop-nav">
                    <!-- Desktop nav links can be added here -->
                </nav>
                <div class="desktop-auth">
                    <a href="/login.html" class="nav-link">Login</a>
                    <a href="/signup.html" class="btn btn-primary">Sign Up</a>
                </div>
                <div class="mobile-menu-toggle">
                    <button id="mobile-menu-button" type="button" class="mobile-menu-btn" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="mobile-menu hidden">
            <div class="mobile-nav-links">
                 <!-- Mobile nav links can be added here -->
            </div>
            <div class="mobile-auth">
                <div class="mobile-auth-links">
                    <a href="/login.html" class="mobile-auth-link">Login</a>
                    <a href="/signup.html" class="btn btn-primary mobile-signup">Sign Up</a>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="hero-section">
            <div class="hero-content">
                <div id="root">
                    <!-- 
                      FIX: The UI containers are now permanent parts of the DOM, living inside #root.
                      This decouples them from Phaser's DOM management, providing a stable
                      foundation for CSS positioning and preventing load/style/positioning bugs.
                      Phaser will inject its canvas as a sibling to these divs.
                    -->
                    <div id="pause-menu-container"></div>
                    <div id="invite-popup-container"></div>
                    <div id="admin-console-container"></div>
                </div>
            </div>
        </section>    
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p class="footer-copyright">&copy; 2024 Breaking Point Games. All rights reserved.</p>
            </div>
        </div>
    </footer>
</div>
<script>
    // Simple mobile menu toggle script
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenuButton.addEventListener('click', () => {
        const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
        mobileMenuButton.setAttribute('aria-expanded', !isExpanded);
        mobileMenu.classList.toggle('hidden');
    });
</script>
<script type="module" src="/index.tsx"></script>
</body>
</html>